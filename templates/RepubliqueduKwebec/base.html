<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Re-Publique Kwébec{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Project CSS (static folder) -->
    <link rel="stylesheet" href="/static/RepubliqueduKwebec/rdkq.css" />
    <link rel="stylesheet" href="/static/RepubliqueduKwebec/glass.css">

    <style>
        /* Make inline modal-trigger link buttons white and bold */
        .btn-link {
            color: #ffffff !important;
            font-weight: 700 !important;
            text-decoration: none !important;
        }

        .btn-link:hover,
        .btn-link:focus {
            color: #ffffff !important;
            text-decoration: underline !important;
        }

        /* Ensure muted text appears white on the dark theme */
        .text-muted {
            color: rgba(255, 255, 255, 0.65) !important;
        }

        /* Links inside muted text should be readable */
        .text-muted a {
            color: rgba(255, 255, 255, 0.9) !important;
            text-decoration: underline;
        }
    </style>

    {% block head %}{% endblock %}
</head>

<body>
    <div class="content-wrapper">

        <!-- Enhanced Navigation Bar -->
        <nav class="navbar navbar-expand-lg fixed-top glass--pro">
            <div class="container-fluid d-flex justify-content-between align-items-center px-4">
                <!-- Brand Logo -->
                <div class="navbar-brand-wrapper">
                    <a class="navbar-brand" href="/">
                        <img src="/static/RepubliqueduKwebec/Photo/Association.png" alt="UMan API"
                            style="height: 42px; margin-right: 12px; filter: drop-shadow(0 2px 8px rgba(0, 230, 195, 0.4));">
                        <span class="text-gradient" style="font-weight: 900; font-size: 1.5rem; letter-spacing: 1.5px;">
                            Re-Publique Kwébec
                        </span>
                    </a>
                </div>

                <!-- Navigation Buttons (imported component) -->
                <!-- Navigation Buttons -->
                {% import 'components/_modal.html' as modal %}
                <div class="nav-buttons-wrapper" style="display: flex; gap: 16px; align-items: center;">
                    <a href="/rdkq" class="btn btn-glass">
                        <i class="fas fa-home mr-2"></i>Accueil
                    </a>
                    <a href="/rdkq/profil" class="btn btn-glass">
                        <i class="fas fa-user mr-2"></i>Mon Profil
                    </a>
                    {% if session.get('user_id') and session.get('is_admin') %}
                    <a href="/rdkq/admin/mediatheque" class="btn btn-glass d-none">
                        <i class="fas fa-photo-video mr-2"></i>Médiathèque Admin
                    </a>
                    <a href="/rdkq/admin" class="btn btn-glass">
                        <i class="fas fa-cog mr-2"></i>Admin
                    </a>
                    {% endif %}
                    {% if session.get('user_id') %}
                    <a href="/rdkq/logout" class="btn btn-glass">
                        <i class="fas fa-sign-out-alt mr-2"></i>Déconnexion
                    </a>
                    {% else %}
                    <a href="/rdkq/login" class="btn btn-glass">
                        <i class="fas fa-sign-in-alt mr-2"></i>Connexion
                    </a>
                    {% endif %}
                </div>

            </div>
        </nav>

        {% block content %}{% endblock %}
    </div>


    <div class="modal fade" id="mediathequeModal" tabindex="-1" aria-labelledby="mediathequeModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content"
                style="background: rgba(26, 26, 46, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1);">
                <div class="modal-header border-bottom border-secondary">
                    <h5 class="modal-title text-white" id="mediathequeModalLabel">
                        <i class="fas fa-photo-video me-2"></i>Médiathèque RDKQ
                    </h5>
                    <h5 class="modal-title" id="manifesteModalLabel">Manifeste</h5>
                    <h5 class="modal-title" id="manifesteModalLabel">Manifeste</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Fermer"></button>
                </div>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <div id="mediatheque-list" class="row">
                        <!-- Les médias seront chargés ici par JavaScript -->
                    </div>
                </div>
                <div class="modal-footer border-top border-secondary">
                    <small class="text-muted me-auto">Cliquez sur "Voir" pour accéder au contenu complet</small>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal Participer -->
    <div class="modal fade" id="participerModal" tabindex="-1" aria-labelledby="participerModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="participerModalLabel">Participer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="form-participer" enctype="multipart/form-data" class="card card-body">
                        <div class="form-group">
                            <label for="nom">Nom</label>
                            <input type="text" class="form-control" id="nom" name="nom" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="sujet">Sujet ou proposition</label>
                            <input type="text" class="form-control" id="sujet" name="sujet" required>
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea class="form-control" id="message" name="message" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="fichier">Pièce jointe (optionnel)</label>
                            <input type="file" class="form-control-file" id="fichier" name="fichier">
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rgpd" name="rgpd" required>
                            <label class="form-check-label" for="rgpd">J'accepte la politique de confidentialité
                                (RGPD)</label>
                        </div>
                        <button type="submit" class="btn btn-primary">Envoyer</button>
                        <div id="resultat-form" class="mt-3"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Registre Foncier -->
    <div class="modal fade" id="registreFoncierModal" tabindex="-1" aria-labelledby="registreFoncierModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registreFoncierModalLabel">Registre Foncier — Re-Publique Kwébec</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <strong>Notice :</strong> Juridiction Common Law Re-Publique Kwébec.
                    </div>
                    <div class="card card-body mb-3">
                        <p>Seul registre autorisé à l'enregistrement des biens immobiliers de nos souverains par droit
                            d'association. Nos
                            chartes des honoraires s'appliquent à tous autre registre, organisme, compagnie ou
                            individus, entités, etc., non
                            autorisés par contrat dûment rempli et signé/autographié.</p>

                        <p><strong>Notice :</strong> Soyez également informé que les définitions du <em>Black's Law Dictionary</em> sont nulles et non avenues, étant un stratagème de fraude et de manipulation du peuple UN. Les définitions des mots que nous utilisons sont celles du dictionnaire Larousse.</p>

                        <h3>Protégez vos biens, affirmez votre souveraineté</h3>
                        <p>À la Ré-publique Kwébec, nous croyons en la protection inaliénable des droits de propriété de
                            chaque citoyen.
                            Le Registre Foncier Re-Publique Kwébec a été créé pour garantir que chaque membre puisse
                            revendiquer, sécuriser
                            et protéger ses terres et propriétés en dehors des systèmes corporatifs traditionnels. Ce
                            registre, ancré dans
                            les principes de la Common Law, permet une gestion et une reconnaissance des biens dans le
                            respect des droits
                            naturels de chacun.</p>

                        <h4>Un registre en pleine croissance</h4>
                        <p>Déjà plus de <strong>200 édifices</strong> enregistrés ! Depuis le 1er janvier 2024, plus de 200 édifices ont été inscrits dans le Registre Foncier Re-Publique Kwébec. Ce succès témoigne de l'engagement des souverains envers une véritable souveraineté patrimoniale et une sécurité renforcée de leurs propriétés. Pour prouver notre transparence, nous avons également sélectionné un immeuble emblématique de la République qui sera visible publiquement sur notre site. Cet édifice servira d'exemple concret pour vous montrer le processus d’enregistrement, la sécurité offerte et l’importance de ce registre.</p>

                        <h4>Pourquoi un registre foncier indépendant ?</h4>
                        <p>L’objectif du Registre Foncier Re-Publique Kwébec est d’assurer à chaque individu une
                            autonomie patrimoniale et
                            une sécurité juridique. Contrairement aux systèmes fonciers classiques souvent soumis aux
                            créances des
                            institutions financières, notre registre a pour objectif de protéger les actifs de nos souverains de toute saisie non souhaitée et de les gérer librement dans le respect des valeurs de souveraineté et d’intégrité.</p>

                        <h4>Avantages</h4>
                        <ul>
                            <li>Reconnaissance des droits de propriété : Inscrivez vos biens pour bénéficier d’une
                                reconnaissance formelle
                                et légitime.</li>
                            <li>Sécurité patrimoniale : Évitez les hypothèques et saisies par des entités externes.</li>
                            <li>Souveraineté individuelle : Assurez-vous que vos terres et propriétés sont protégées par
                                des lois qui
                                respectent vos droits fondamentaux.</li>
                            <li>Transparence garantie : affichage public de certains édifices inscrits.</li>
                        </ul>

                        <h4>Comment s’inscrire ?</h4>
                        <p>Nous offrons une démarche simple et sécurisée pour enregistrer vos biens dans votre registre
                            foncier. Pour en
                            savoir plus sur les étapes d’inscription et les documents nécessaires, contactez vos
                            conseillers ou utilisez le
                            formulaire de participation ci‑dessous.</p>

                        <p class="mt-3"><a href="rdkq/register" class="btn btn-primary">S'inscrire au Registre Foncier</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Smart Contracts -->
    <div class="modal fade" id="smartContractModal" tabindex="-1" aria-labelledby="smartContractModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="smartContractModalLabel">Exemple : «Smart Contract» dans la Re-Publique
                        Kwébec</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <div class="card card-body mb-3">
                        <p>Imaginons que la Banque du Peuple de la Re-Publique Kwébec mette en place un système de
                            soutien aux créateurs de contenu citoyen (documentaires, tribunaux populaires, formations en
                            sociocratie, etc.).</p>

                        <p>Un «Smart Contract» pourrait être programmé ainsi :</p>

                        <ol>
                            <li>Un souverain s’abonne à un créateur avec la Monnaie Souveraine.</li>
                            <li>Dès que le paiement est confirmé, le «Smart Contract» :</li>
                            <ul>
                                <li>transfère 80 % au créateur,</li>
                                <li>alloue 15 % à l’infrastructure de la plateforme,</li>
                                <li>et réserve 5 % dans un fonds communautaire (ex. formation, sécurité, projets
                                    sociaux).</li>
                            </ul>
                            <li>Si le créateur publie régulièrement (selon les critères établis par la communauté), le
                                «Smart Contract» déclenche automatiquement une prime d’engagement.</li>
                        </ol>

                        <p><strong>Personne n’a besoin d’intermédiaire</strong> (banque, administrateur ou compagnie).
                            Tout est automatisé, transparent et vérifiable par la communauté.</p>

                        <h6>Pourquoi c’est puissant dans ton contexte ?</h6>
                        <p>Ça reflète la CyberSociocratie : les règles sont décidées collectivement et exécutées
                            automatiquement.</p>
                        <p>Ça soutient la Banque du Peuple et la Monnaie Souveraine.</p>
                        <p>Ça garantit que chaque don, abonnement ou participation citoyenne est juste, traçable et
                            sécurisé.</p>

                        <p class="mt-3"><strong>En une phrase :</strong><br>
                            Dans la Re-Publique Kwébec, un «Smart Contract», c’est le notaire numérique du peuple : il
                            applique nos décisions collectives automatiquement, sans intermédiaires ni abus.</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour l'historique du membre -->
    <div class="modal fade" id="modal-membre-historique" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Historique du membre</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="card card-body mb-3">
                        <ul class="nav nav-tabs" id="historique-tabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-bs-toggle="tab"
                                    href="#tab-decisions-historique">Décisions</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab" href="#tab-adhesions-historique">Adhésions</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab"
                                    href="#tab-publications-historique">Publications</a>
                            </li>
                        </ul>
                        <div class="tab-content mt-3" id="historique-tab-content">
                            <div class="tab-pane fade show active" id="tab-decisions-historique">
                                <div class="table-responsive">
                                    <table class="table table-sm" id="table-decisions-historique">
                                        <thead>
                                            <tr>
                                                <th>Titre</th>
                                                <th>Type</th>
                                                <th>Vote</th>
                                                <th>Date</th>
                                                <th>Statut</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="tab-adhesions-historique">
                                <div class="table-responsive">
                                    <table class="table table-sm" id="table-adhesions-historique">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Date début</th>
                                                <th>Date fin</th>
                                                <th>Statut</th>
                                                <th>Durée</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="tab-publications-historique">
                                <div class="table-responsive">
                                    <table class="table table-sm" id="table-publications-historique">
                                        <thead>
                                            <tr>
                                                <th>Titre</th>
                                                <th>Type</th>
                                                <th>Date</th>
                                                <th>Statut</th>
                                                <th>Vues</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Manifeste -->
    <div class="modal fade" id="manifesteModal" tabindex="-1" aria-labelledby="manifesteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="manifesteModalLabel">Manifeste</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <div class="card card-body mb-3">
                        <p>La Re-Publique Kwébec vise l'indépendance, la transparence, la sécurité des données et
                            l'accessibilité pour
                            tous les souverains. Découvrez notre vision et nos engagements dans le manifeste complet.
                        </p>

                        <h4>Manifeste — Re-Publique Kwébec</h4>
                        <p>Chères membres de l'Association Re-Publique Kwébec,</p>
                        <p>Nous avons le plaisir de vous annoncer un changement important et symbolique pour notre
                            mouvement. À partir
                            d'aujourd'hui, nous adoptons officiellement le nom <strong>Re-Publique Kwébec</strong>. Ce
                            changement est
                            motivé par notre désir de renforcer notre identité unique, de moderniser notre langage, et
                            de souligner le
                            symbolisme profond qui accompagne notre vision.</p>

                        <p>Le changement de nom s’inscrit dans notre démarche de reprogrammation positive de notre
                            langage. Tout comme
                            nous remplaçons les termes négatifs par des mots qui évoquent la coopération et l’unité, le
                            passage à "Kwébec"
                            reflète notre volonté de moderniser et d’harmoniser notre communication. Ce geste
                            linguistique renforce notre
                            mission de créer un environnement où chaque mot porte un sens constructif et positif.</p>

                        <p>Le nouveau nom, <strong>Re-Publique Kwébec</strong>, marque notre distinction par rapport à
                            la province du
                            Québec telle qu’elle est communément connue. En choisissant "Kwébec", nous affirmons notre
                            autonomie et notre
                            volonté de créer une société parallèle, indépendante et libre des structures étatiques et
                            corporatives
                            actuelles.</p>

                        <p><strong>Re-Publique Kwébec : Notre Salut, Notre Liberté</strong></p>

                        <p>En innu, le mot Kwé signifie « Salut ! », une formule d’accueil simple, directe et
                            fraternelle.
                            En ce dissociant de Québec, nous affirmons une identité renouvelée, une république vivante
                            qui s’ancre dans
                            l’histoire et l’avenir.</p>

                        <p class="lead">👉 Re-Publique Kwébec : Notre Salut, Notre Liberté</p>

                        <p>Ce n’est pas seulement un nom, mais une déclaration :</p>

                        <p><em>Notre salut est notre liberté.</em></p>

                        <p>Chaque salut échangé est un acte de reconnaissance entre hommes et femmes vivants libres.</p>

                        <p>C’est un signe d’unité, d’indépendance et de souveraineté.</p>

                        <p>Ainsi, Re-Publique Kwébec devient plus qu’un mot.
                            C’est un appel, un slogan et un serment collectif porté par le peuple :</p>

                        <p class="text-center">✨ <strong>Notre Salut, Notre Liberté.</strong></p>

                        <p>Pour aller plus loin, découvrez nos thèmes majeurs ou participez dès maintenant.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Profil public -->
    <div class="modal fade" id="profilModal" tabindex="-1" aria-labelledby="profilModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profilModalLabel">Profil public</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <div id="profil-public" class="card card-body">
                        <p>Consultez le profil public d'un membre, ses biens enregistrés et ses documents.</p>
                        <input type="text" class="form-control mb-2" id="profil-search" placeholder="Nom du membre">
                        <button class="btn btn-outline-info btn-sm" id="btn-search-profil">Rechercher</button>
                        <div id="profil-result" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Core scripts (Bootstrap bundle) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Project scripts -->
    <script src="/static/RepubliqueduKwebec/rdkq.js"></script>
    <script src="/static/democratie.js"></script>

    <!-- Médiathèque Modal Script -->
    <script>
        // Fonction pour charger la médiathèque dans la modale
        async function loadMediathequeModal() {
            const mediaList = document.getElementById('mediatheque-list');

            try {
                // Afficher un loader
                mediaList.innerHTML = '<div class="col-12 text-center"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Chargement...</span></div></div>';

                const response = await fetch('/rdkq/mediatheque');
                const medias = await response.json();

                if (medias && medias.length > 0) {
                    displayMediasInModal(medias);
                } else {
                    mediaList.innerHTML = '<div class="col-12 text-center"><p class="text-muted">Aucun média disponible pour le moment.</p></div>';
                }
            } catch (error) {
                console.error('Erreur lors du chargement de la médiathèque:', error);
                mediaList.innerHTML = '<div class="col-12 text-center"><p class="text-danger">Erreur lors du chargement des médias.</p></div>';
            }
        }

        function displayMediasInModal(medias) {
            const mediaList = document.getElementById('mediatheque-list');
            let html = '';

            medias.forEach(media => {
                const imageUrl = media.img || '/static/image/default-media.png';
                const documentUrl = media.src || '#';
                const views = media.views || 0;
                const category = media.category || '';
                const author = media.author || 'Anonyme';

                html += `
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="card h-100" style="background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);">
                            <img src="${imageUrl}" class="card-img-top" alt="${media.title}" style="height: 200px; object-fit: cover;" onerror="this.src='/static/image/default-media.png'">
                            <div class="card-body d-flex flex-column">
                                <h6 class="card-title text-white">${media.title}</h6>
                                <p class="card-text text-light small">${media.desc || ''}</p>
                                <div class="mt-auto">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span class="badge bg-secondary">${category}</span>
                                        <small class="text-muted">${views} vues</small>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">Par ${author}</small>
                                        ${documentUrl !== '#' ? `<a href="${documentUrl}" target="_blank" class="btn btn-primary btn-sm" onclick="incrementViews(${media.id})">Voir</a>` : '<span class="text-muted">Bientôt disponible</span>'}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            mediaList.innerHTML = html;
        }

        // Fonction pour incrémenter les vues
        async function incrementViews(mediaId) {
            try {
                await fetch(`/rdkq/mediatheque/${mediaId}/view`, {
                    method: 'POST'
                });
            } catch (error) {
                console.error('Erreur lors de l\'incrémentation des vues:', error);
            }
        }

        // Charger la médiathèque quand la modale s'ouvre
        document.addEventListener('DOMContentLoaded', function () {
            const mediathequeModal = document.getElementById('mediathequeModal');
            if (mediathequeModal) {
                mediathequeModal.addEventListener('show.bs.modal', function () {
                    loadMediathequeModal();
                });
            }
        });
    </script>

    {% block scripts %}{% endblock %}
</body>

</html>